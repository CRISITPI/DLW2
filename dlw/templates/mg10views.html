{% block content %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/js/select2.min.js"></script>



<style>
    input[type=text],
    select {
        width: 100%;
        padding: 12px 20px;
        margin: 8px 0;
        display: block;
        border: 2.5px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }
    
    input[type=submit] {
        width: 20%;
        text-align: center;
        background-color: #4CAF50;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    input[type=submit]:hover {
        background-color: #45a049;
        text-align: center;
    }
    
    input[type=button] {
        width: 10%;
        text-align: center;
        background-color: #4CAF50;
        color: white;
        padding: 6px 6px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    input[type=button]:hover {
        background-color: #45a049;
        text-align: center;
    }
</style>
<br>
<br>
<h1 align="center" >प्रोत्साहन बोनस विवरण-1</h1>
<h1 align="center" >INCENTIVE BONUS STATEMENT-1</h1>
<br><br>
<form action="{% url 'mg10views' %}" method="POST"> {% csrf_token %}
    <div class="container">
        <table class="table" align="center">
            <tr>
                <td>
                    <label for="date"><b>Date</b></label>
                    <input id="date" type="date" name="date" maxlength="20" value={{date}}>
                </td>
                <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </td>
            
                <td>
                    <label for="sno"><b>Shop Section/शॉप अनुभाग :</b></label>
                    <select class="form-control" id="shop_sec" name="shop_sec" required>
                    <option id="op_shop" selected disabled hidden>Select Shop Section</option>
                    {% if lenm == 1 %}
                        <option selected readonly>{% for role in roles %}{{role}}{% endfor %}</option>
                        {{role}}
                    {% endif %}
                    {% if lenm > 1 %}
                    {% for role in roles %}
                        {{role}}
                        <option>{{role}}</option>
                    {% endfor %}
                    {% endif %}
                    </select>

                </td>
                <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                </td>
                <td>
                    <label for="month"><b>Month/माह :</b></label>
                    <select id="month" name="month">
                        <option value="select">SELECT MONTH</option>
                        <option value="JAN">JAN</option>
                        <option value="FEB">FEB</option>
                        <option value="MAR">MAR</option>
                        <option value="APR">APR</option>
                        <option value="MAY">MAY</option>
                        <option value="JUN">JUN</option>
                        <option value="JUL">JUL</option>
                        <option value="AUG">AUG</option>
                        <option value="SEPT">SEPT</option>
                        <option value="OCT">OCT</option>
                        <option value="NOV">NOV</option>
                        <option value="DEC">DEC</option>
                    </select>
                </td>
            </tr>
        
        </table>
        <center>
        <input type="hidden" name="inoutnum" id="inoutnum" value="0" />
        <input align="center" type="submit" value="Proceed" name="proceed" id="myproceed" />
        </center>
        {% comment %} <center>
        <input type="hidden" name="inoutnum" id="inoutnum" value="0" />
        <input align="center" type="submit" value="Proceed" name="proceed" id="myproceed" hidden/>
        </center>     {% endcomment %}
        
        <input type="hidden" name="subb" id="subb" value="{{sub}}">
        {% if sub == 1 %}
        <input type="hidden" name="len" id="len" value="{{leng}}">
    </div>
<br>

<table align="center" rules="none">  
    <tr>
        <th>SHOP SECTION/शाप विभाग :</th> 
        <td><u>{{shop_sec}}</u></td>
        <input type="hidden" name="shop_sec" value="{{shop_sec}}">
    </tr>
    <tr class="blank_row">
        <td>&nbsp;</td>
    </tr>
    <tr>
        <th>MONTH/माह:</th> 
        <td><u>{{month}}</u></td>
        <input type="hidden" name="month" value="{{month}}">
    </tr>
    <tr class="blank_row">
        <td>&nbsp;</td>
    </tr>
    <tr>
        <th>Date/दिनांक :</th> 
        <td><u>{{date}}</u></td>
        <input type="hidden" name="date" value="{{date}}">
    </tr>
    <tr class="blank_row">
        <td>&nbsp;</td>
    </tr>
</table>

<br><br>
<div class="container" style="width: 100%">
    <table  border="4"  align="center" >
        <tr>
            
        
            <th colspan="2">SL. NO.</th>
            <th colspan="2">TICKET NO.</th>
            <th colspan="2">NAME</th>
            <th colspan="2">CATEGORY</th>
            <th colspan="2">RATE OF PAY</th>
            <th colspan="2">DATE WORKED AS E.I.W</th>
            <th colspan="2">REMARKS</th>
                                
        </tr>
        {% for i in obj1 %}
        <tr>
            <td>
                <input type="text"  name="sno" id="sno" value="{{wer}}" readonly>
            </td>

            <td>
                <select class="form-control" type="text" id="ticket" name="ticket" required onchange="find1(this)">
                <option id="op_ticket" selected disabled hidden>Select Ticket No</option>
                {% for i in prtticket %}
                    <option value="{{i}}">{{i}}</option>
                {% endfor %} 
                </select> 
            </td>

            <td>
                <select class="form-control" type="text" id="name" name="name" required>
                <option id="op_name" selected disabled hidden>Select NAME</option>
                {% comment %} {% for i in prtname %}
                    <option value="{{i}}">{{i}}</option>
                {% endfor %}
                </select>  {% endcomment %}
            </td>

            <td>
                <select class="form-control" type="text" id="category" name="category" required>
                <option id="op_cat" selected disabled hidden>Select CATEGORY</option>
                {% comment %} {% for i in prtemp %}
                    <option value="{{i}}">{{i}}</option>
                {% endfor %} {% endcomment %}
                </select>
            </td>

            <td>
                <select class="form-control" type="text" id="payrate" name="payrate" required>
                <option id="op_payrt" selected disabled hidden>Select PAYRATE</option>
                {% for i in prtpay %}
                    <option value="{{i}}">{{i}}</option>
                {% endfor %}
                </select>
            </td>

            <td>
                <input id="eiwdate" type="date" name="eiwdate" required>
                <input type="hidden" name="eiwdate"  value="{{eiwdate}}">
            </td>

            <td>
                <input id="remark" type="text" name="remark" maxlength="30" required>
                <input type="hidden" name="remark"  value="{{remark}}">
            </td>
        </tr>
        {% endfor %}

    </table>
    <div id="inouttab">
</div>
    <br><br>
    
<center>
<input  type="button" id="add" value="Add Operations" style="width: 150px;"/>
<input type="hidden" name="num" value="THE OUTPUT OF OPERATION FUNCTION" id="myvalue"/>
</center>
    </div>
<input type="hidden" name="total" value="" id="total"/>

<div id="items">
<br>
</div>
    <br><br><br>
    <center>
        <input type="submit" name="proceed" value="submit"/>
    </center>
        {% endif %}

</form>

<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script type="text/javaScript">



var j=0;
$("#add").click(function(e){
    event.preventDefault()
    j++;
    console.log(j);


    var slno="sno"+String(j);
    var ticket="ticket"+String(j);
    var name="name"+String(j);
    var category="category"+String(j);
    var payrate="payrate"+String(j);
    var eiwdate="eiwdate"+String(j);
    var remark="remark"+String(j);
    
    
    document.getElementById("total").value=j;

    var htAppend='<div><table id="customers" border="2" align="center"><tr>'+'<td ><input type="text" id='+slno+' name='+slno+' value="{{wer}}" required /></td >'+'<td><select class="form-control" type="text" id="'+ticket+'" name="'+ticket+'" onchange="find1(this)" required><option id="op_ticket" selected disabled hidden>Select Ticket No</option>{% for i in prtticket %}<option value="{{i}}">{{i}}</option>{% endfor %}</select></td >'+'<td ><input type="text" id="'+name+'" name="'+name+'" value="{{name}}" required></td >'+'<td ><input type="text" id="'+category+'" name="'+category+'"  value="{{category}}" required>'+'<td ><select class="form-control" type="text" id="payrate" name="payrate" required><option id="op_payrt" selected disabled hidden>Select PAYRATE</option>{% for i in prtpay %}<option value="{{i}}">{{i}}</option>{% endfor %}</select></td >'+'<td ><input type="date" id='+eiwdate+' name='+eiwdate+' required /></td >'+'<td ><input type="text" id='+remark+' name='+remark+' required /></td >';
    htAppend=htAppend+'</tr></table>'+'</div>';
    //$('#items').append(htAppend);
    $('#inouttab').append(htAppend);
    document.getElementById("inoutnum").value=j;
    //document.getElementById("inoutnum").value=j; 
    //document.getElementById("items").value=j;
});

function assign(){
        function operation()
        {
        console.log(j);
        return j;
        }
       document.getElementById('myvalue').value =operation();
    } 


function find1(th){
    var id = th.id;
    console.log("id "+id);
    tic=id.split("ticket");
    name=id.split("name");
    two=document.getElementById(id).value;
    var data={two};
                    $.ajax({
                        type: 'GET',
                        url : "{% url 'mg10getcat' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                            console.log(response,"kjk");
                        // document.getElementById().value=response;
                        console.log("gjhgyjgygu",response.cont.prt) 

                        document.getElementById("category"+tic[1]).value=response.cont.prt;
                        
                        }
                    })

                    $.ajax({
                        type: 'GET',
                        url : "{% url 'mg10getname' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                            console.log(response,"getname");
                        // document.getElementById().value=response;
                        console.log("name---dhshshd",response.cont.prt) 

                        document.getElementById("name"+tic[1]).value=response.cont.prt;
                        
                        }
                    })
} 
{% comment %} document.querySelector("#eiwdate").addEventListener('change',(e)=>{
    //console.log("hi");
                    e.preventDefault();
                    var eiwdate = $("#eiwdate").val()
                    var shop_sec = $("#shop_sec").val()
                    var ticket = $("#ticket").val()
                    var data = {shop_sec,ticket};
                      $.ajax({
                        type : 'GET',
                        url : "{% url 'mg10checkdate' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                            alert("pls select a valid date");
                        }
                          })
                }) {% endcomment %}





                     





{% comment %} document.querySelector("#ticket").addEventListener('change',(e)=>{
    //console.log("hi");
                    e.preventDefault();
                    var shop_sec = $("#shop_sec").val()
                    var ticket = $("#ticket").val()
                    var data = {shop_sec,ticket};
                      $.ajax({
                        type : 'GET',
                        url : "{% url 'mg10getname' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                            var elementsadded = document.querySelectorAll(".newelename");
                              if(elementsadded.length>0){
                                  var elementsaddedarr = Array.from(elementsadded);
                                  elementsaddedarr.forEach((el)=> el.remove());
                                  document.querySelector("#op_name").selected = true;                 
                              }
                              var brarr,mystr,html;
                              brarr = response.map((el)=>el.staff_no);
                              mystr = "";
                              brarr.forEach((el,index)=>{
                                html = `<option class=".newelename">${brarr[index]}</option>`
                                mystr = html.concat(mystr);
                              });
                              html = "";
                              document.querySelector("#ticket").insertAdjacentHTML('beforeend',mystr);
                              mystr=""; 
                        }
                          })
                }) {% endcomment %}

{% comment %} 
document.querySelector("#ticket").addEventListener('change',(e)=>{
    //console.log("hi");
                    e.preventDefault();
                    var shop_sec = $("#shop_sec").val()
                    var ticket = $("#ticket").val()
                    var data = {shop_sec,ticket};
                      $.ajax({
                        type : 'GET',
                        url : "{% url 'mg10getcat' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                            var elementsadded = document.querySelectorAll(".newelecat");
                              if(elementsadded.length>0){
                                  var elementsaddedarr = Array.from(elementsadded);
                                  elementsaddedarr.forEach((el)=> el.remove());
                                  document.querySelector("#op_cat").selected = true;                 
                              }
                              var brarr,mystr,html;
                              brarr = response.map((el)=>el.cat);
                              mystr = "";
                              brarr.forEach((el,index)=>{
                                html = `<option class=".newelecat">${brarr[index]}</option>`
                                mystr = html.concat(mystr);
                              });
                              html = "";
                              document.querySelector("#ticket").insertAdjacentHTML('beforeend',mystr);
                              mystr=""; 
                        }
                          })
                })   {% endcomment %}





{% comment %} document.addEventListener('keypress',(event)=>{
if(event.keyCode===13){
    event.preventDefault();
}
}) {% endcomment %}

</script>









{% endblock content %}