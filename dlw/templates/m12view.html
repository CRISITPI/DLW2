{% extends 'base.html' %} {% block content %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/js/select2.min.js"></script>

<style>
  input[type=text],
  select {
      width: 100%;
      padding: 12px 20px;
      margin: 8px 0;
      display: block;
      border: 0.5px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
  }
  
  input[type=submit] {
      width: 20%;
      text-align: center;
      background-color: #4CAF50;
      color: white;
      padding: 14px 20px;
      margin: 8px 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
  }
  
  input[type=submit]:hover {
      background-color: #45a049;
      text-align: center;
  }
  
  input[type=button] {
      width: 10%;
      text-align: center;
      background-color: #4CAF50;
      color: white;
      padding: 6px 6px;
      margin: 8px 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
  }
  
  input[type=button]:hover {
      background-color: #45a049;
      text-align: center;
  }
</style>
<br>
<br>
<h3 align="center">MACHINE IDLE TIME CARD</h3>
<br><br>
<form action="{% url 'm12view' %}" method="POST"> {% csrf_token %}
    <div class="container">
        <table class="table">
            <tr>
                <td>
                    <label for="month"><b>Month/माह :</b></label>
                    <select class="form-control" id="month" name="month">
                            <option value="select">SELECT MONTH</option>
                            <option value="JAN">JAN</option>
                            <option value="FEB">FEB</option>
                            <option value="MAR">MAR</option>
                            <option value="APR">APR</option>
                            <option value="MAY">MAY</option>
                            <option value="JUN">JUNE</option>
                            <option value="JULY">JULY</option>
                            <option value="AUG">AUG</option>
                            <option value="SEPT">SEPT</option>
                            <option value="OCT">OCT</option>
                            <option value="NOV">NOV</option>
                            <option value="DEC">DEC</option>
                    </select>
                </td>
                <td>
                    <label for="sno"><b>Shop Section NO/शॉप अधी.:</b></label>
                    <select class="form-control" id="shop_sec" name="shop_sec" required>
            <option id="op_shop" selected disabled hidden>Select Shop Section</option>
            {% if len == 1 %}
                <option selected readonly>{% for role in roles %}{{role}}{% endfor %}</option>
            {% endif %}
            {% if len > 1 %}
            {% for role in roles %}
              <option value="{{role}}">{{role}}</option>
            {% endfor %}
            {% endif %}
        </select>
                </td>
                <td>
                    <label for="wk_ord_no"><b>Work Order NO:/कार्यादेश सं. :</b></label>
                    <select class="form-control" id="wno" name="wo_no" required>
        <option id="op_wo" selected disabled hidden>Select Work Order NO</option>
        {% if len == 1 %}
        {% for i in wo_no %}
          <option>{{i.bo_no}}</option>
        {% endfor %}
        {% endif %}
    </select>
                </td>
                
                  <td>
                  <label for="staff_no"><b>Employee Number:</b></label>
                  <select class="form-control" id="staff_no" name="staff_no" required>
          <option id="op_staff" selected disabled hidden>Select Employee No</option>
      </select>
              </td>
            </tr>


        </table>
        <input type="hidden" name="inoutnum" id="inoutnum" value="0" />

        
        <center><input type="submit" value="Proceed" id="myproceed" name="proceed" hidden /></center>


    </div>
    <input type="hidden" name="len" id="len" value="{{lent}}">
    <input type="hidden" name="subb" id="subb" value="{{sub}}">

    <br><br> {% if sub == 1 %}
    <div id="print" style="align:center" >
    
    
    <div class="container" style="width: 100%">
        
        &nbsp;&nbsp;&nbsp;&nbsp;
       <h5><b>SHOP SECTION: </b> {{shop_sec}}</h5>
       <input type="hidden" name="shopsec" value="{{shop_sec}}">
       
       <h5><b>STAFF NO:</b> {{staff_no}}
        <input type="hidden" name="staff_no" value="{{staff_no}}">
         </h5>
        
       <h5><b>MONTH: </b>
       {% if obj3.month %}
        {{obj3.month}}
       {% else %}
       {{month}} 
       {% endif %}
       <input type="hidden" name="month" value="{{month}}" pattern="[A-Z]*{3}" title="Upper case alphabets only" />
       </h5>
       
       <h5><b>WORK ORDER NUMBER: </b>{{wo_no}}</h5>

       <h5><b>TIME HOURS: </b>
        
         {{r1}}  
         

        
              </h5>

       <h5><b>AMOUNT: </b>
         {{amt1|floatformat:2}}  
         <input type="hidden" name="amt" value="{{amt1}}">
  
      </h5>

       
       </h5>
       
       </div>
       
  
  </br>

 

    <!--<form action="." method = "POST">  {% csrf_token %}-->
        <!-- <div class="container" style="width: 140%"> -->
        <table border="4"  style="width:100%">
            <tr >
               <th>STAFF NO:</th>
               <th width="200">STAFF NAME</th> 
               <th>MONTH</th>
               <th width="200">SHIFT TYPE</th>             
               <th width="175">IN DATE</th>
               <th width="90">IN TIME</th>
               <th width="175">OUT DATE</th>
               <th >OUT TIME</th>
               <th>CATEGORY</th>
               <th >REASONS FOR IDLE TIME</th>
               <th>TOTAL TIME</th>
               <th>IDLE TIME</th>
                            
             <input type="hidden" id="cmonth" value="{{month}}"/>
           </tr>
            {% for i in obj1 %}
            <tr>
            <td>
              {% if i.staff_no %}
                <input type="text" id="staff_no"  class="myinp2" value="{{i.staff_no}}" name="staff_no{{ forloop.counter }}"  readonly>
                {% else %}
                <input type="TEXT" id="staff_no"  class="myinp2" value="0" name="staff_no{{ forloop.counter }}" readonly>
              {% endif %}  
            </td>
            <td>
                {% if i.name %}
                  <input type="text" id="name"  class="myinp2" value="{{i.name}}" name="name{{ forloop.counter }}"  readonly>
                  {% else %}
                  <input type="text" id="name"  class="myinp2"  name="name{{ forloop.counter }}" readonly>
                {% endif %}  
              </td>
            <td>

              {% if i.month %}
                <input type="text" id="month" value="{{i.month}}" name="month{{ forloop.counter }}"  pattern="[A-Z]*" title="Character Value" required  readonly>  
                {% else %}
                <input type="text" id="month" value="{{month}}" name="month{{ forloop.counter }}"  pattern="[A-Z]*"  title="Character Value" required placeholder="Enter month" readonly>
                {% endif %}  
            </td>
            <td>
                {% if i.shift_typename %}
                <input type="text" id="shift_typename{{ forloop.counter }}"  class="myinps1" value="{{i.shift_typename}}" name="in_date{{ forloop.counter }}"    readonly>
                {% else %}
                <input type="text" id="shift_typename{{ forloop.counter }}"  class="myinps1" value="0" name="shift_typename{ forloop.counter }}"   readonly>
                
              {% endif %}
            </td>
            <td>
                {% if i.in_date %}
                  <input type="date" id="in_date{{ forloop.counter }}"  class="myinps1" value="{{i.in_date}}" name="in_date{{ forloop.counter }}"    readonly>
                  {% else %}
                  <input type="date" id="in_date{{ forloop.counter }}"  class="myinps1" value="0" name="in_date{{ forloop.counter }}"  onchange="tottime('in1{{ forloop.counter }}');"  placeholder="Enter IN time" readonly>
                  
                {% endif %}
            </td>
            <td>
              {% if i.in1 %}
                <input type="time" id="in1{{ forloop.counter }}"  class="myinps1" value="{{i.in1}}" name="in1{{ forloop.counter }}"  onchange="tottime('in1{{ forloop.counter }}');"  readonly>
                {% else %}
                <input type="time" id="in1{{ forloop.counter }}"  class="myinps1" value="0" name="in1{{ forloop.counter }}"  onchange="tottime('in1{{ forloop.counter }}');"  placeholder="Enter IN time" readonly>
                
              {% endif %}  
              
              </td> 
              <td>
                  {% if i.out_date %}
                     <input type="date" id="out_date{{ forloop.counter }}"  class="myinps1" value="{{i.out_date}}" name="out{{ forloop.counter }}"    readonly  >
                     {% else %}
                     
                     <input type="date" id="out_date{{ forloop.counter }}"  class="myinps1" name="out_date{{ forloop.counter }}"     placeholder="Enter OUT time" readonly>
           
                   {% endif %}    
             
                  </td> 
              <td>
               {% if i.out %}
                  <input type="time" id="out{{ forloop.counter }}"  class="myinps1" value="{{i.out}}" name="out{{ forloop.counter }}"   onchange="tottime('out{{ forloop.counter }}');" readonly  >
                  {% else %}
                  
                  <input type="time" id="out{{ forloop.counter }}"  class="myinps1" value="0" name="out{{ forloop.counter }}"   onchange="tottime('out{{ forloop.counter }}');"  placeholder="Enter OUT time" readonly>
        
                {% endif %}    
          
               </td> 
               <td>
                
                  <input type="text" id="cat{{ forloop.counter }}"   value="{{i.cat}}"  name="cat{{ forloop.counter }}"  placeholder="Enter Category" readonly >
                  
                </td>
               <td>
                  {% if i.reasons_for_idle_time %}
                  <input type="text" id="reasons_for_idle_time{{forloop.counter}}" value="{{i.reasons_for_idle_time}}" readonly>
                  {% else %}
                  <input type="text" id="reasons_for_idle_time{{forloop.counter}}" value="0" readonly>
                  {% endif %}  
                
                 
                <!-- {% if i.reasons_for_idle_time %}
                <input type="text" id="reasons_for_idle_time{{ forloop.counter }}"   value="{{i.reasons_for_idle_time}}"  name="reasons_for_idle_time{{ forloop.counter }}"   >
                 {% else %}
                <input type="text" id="reasons_for_idle_time{{ forloop.counter }}"   value="0"  name="reasons_for_idle_time{{ forloop.counter }}"  >
               {% endif %}   -->
              </td>
               <td>
                  {% if i.total_time %}
                   <input type="text" id="total_time{{ forloop.counter }} "   value="{{i.total_time}}"  name="total_time{{ forloop.counter }}"  readonly >
                    {% else %}
                   <input type="text" id="total_time{{ forloop.counter }} "   value="0" name="total_time{{ forloop.counter }}" readonly >
                  {% endif %}  
                </td>
                <td>
                    {% if i.idle_time %}
                     <input type="text" id="idle_time"  value="{{i.idle_time}}" name="idle_time{{ forloop.counter }}" readonly >
                      {% else %}
                     <input type="time" id="idle_time"   value="0" name="idle_time{{ forloop.counter }}" placeholder="Enter Idle time" readonly>
                    {% endif %}  
                  </td>
                
                
</tr>
            {% endfor %}
        </table>
       
        <div id="inouttab">

       </div>
                <br><br>

<br><br>
</div>
</div>
<center>
    <input type="submit" name="proceed" value="submit" style="height:50px; width:100px">
    <input type="button" onclick="printDiv()" value="print" style="height:50px; width:100px">
   
    <input  type="button" id="add" value="Add Operations" style="height:50px; width:100px"/>

</center>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


<input type="hidden" name="num" value="THE OUTPUT OF OPERATION FUNCTION" id="myvalue"/>
       
    

</form>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


<div id="items">


    </div>
    {% endif %}

<br>
    <br><br><br>

<br>










</form>


</body>
</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<script language="javascript">
// var j=0;

// $(document).ready(function(){
//     $("#add").click(function(e){
//         event.preventDefault()

var j=0;

$(document).ready(function(){
    var sub =document.getElementById('subb').value;
    if(sub==1)
    {
        var leng=document.getElementById('len').value;
        console.log(leng,"leng");
        for (i=1;i<=leng;i++)
        {
        var detail_no=document.getElementById('reasons_for_idle_time'+String(i)).value;
        console.log("detai_no",detail_no);
        $("#reasons_for_idle_time_noid"+String(i)).val(detail_no);
        }
        
    }
    $("#add").click(function(e){
        event.preventDefault()





        j++;
        console.log(j);
        assign();
       var staff_no2="staff_noadd"+String(j);
       var exam_type="staff_nameadd"+String(j);
       var out_date="out_dateadd"+String(j);
       var in_date="in_dateadd"+String(j);

       var shift="shiftadd"+String(j);
      //  var outid="'"+out+"'";
      //  var in1id="'"+out+"'";
       var cat="catadd"+String(j);
      //  var ticket_no="ticket_noadd"+String(j);
      //  var month_hrs="month_hrsadd"+String(j)
      //  var total_time_taken="total_time_takenadd"+String(j);
       
 
      //  var date="dateadd"+String(j)
       var month="month_add"+String(j)
       var in1="in1add"+String(j);
       var out="outadd"+String(j);
      //  var cat="catadd"+String(j);
       var outid="'"+out+"'";
       var in1id="'"+out+"'";
     
       
      var reasons_for_idle_time = "reasons_for_idle_timeadd"+String(j)

       var total_time="total_time_add"+String(j);
       var idle_time="idle_time_add"+String(j);
       //reasons_for_idle_time = "reasons_for_idle_time_noadd"+String(j)

       
      
       var sno=j;
       


            var happ='<div class="table-responsive"><table id="customers" border="2" >'+'<tr ><th  style="width:12%">Date</th>'+'<tr ><th  style="width:12%">Month</th>'+'<tr ><th  style="width:12%">In</th>'+
'<th style="width:12%">OUT</th>'+'<th  style="width:12%">Category</th>'+'<th  style="width:12%">Reasons</th>'+'<th  style="width:12%">Total Time.</th>'+'<th  style="width:12%">Idle Time</th></tr>';

     happ=happ+'</tr></table></div>';
        // $('#items').append(happ);
        // $('#inouttab').append(happ);

        
var htAppend='<div><table id="customers" border="4" style="width:100%"><tr>'+'<td  ><select class="form-control" type=text id='+staff_no2+' name='+staff_no2+' required  onchange="find2(this)" ><option id="op_forman" selected disabled hidden>Select Staff_no</option>{% for i in prtstaff %}<option value="{{i}}">{{i}}</option>{% endfor %} </select></td >'+'<td ><input type="text" id="'+exam_type+'" name="'+exam_type+'" value="{{exam_type}}" readonly placeholder="Staff Name"></td>'+'<td width="115" ><input type="text" id='+month+' name='+month+'  value="{{month}}" pattern="[A-Z]*" title="Upper case alphabets only" placeholder="MONTH" required onblur="check(this)" readonly/></td >'+'<td> <select class="form-control" id='+shift+' name='+shift+' onchange="myFunction(this)" required><option value="select">SELECT SHIFT TYPE</option><option value="A">A</option><option value="B">B</option><option value="C">C</option><option value="GD">GD</option><option value="GN">GN</option></td>'+'<td width="5" ><input type="date" id='+in_date+' name='+in_date+'  required  /> <input type="text" name="cyear"  id="cyear" value="{{cyear}}" hidden></td >'+'<td   ><input type="time" id='+in1+' name='+in1+'  min="06:27" max="06:45" onchange="tottime('+in1id+')"  required></td >'+'<td ><input type="date" id='+out_date+' name='+out_date+' required /></td >'+'<td ><input type="time" id='+out+' name='+out+'   min="14:30" max="14:45"  onchange="tottime('+outid+')"  required/></td>'+'<td ><input type="text" id='+cat+' name='+cat+' placeholder="Category" required/></td>'+' <td  ><select name='+reasons_for_idle_time+' id='+reasons_for_idle_time+' required> <option value="select">SELECT REASON</option><option value="machine_repair">MACHINE REPAIR</option> <option value="no_power">NO POWER</option> <option value="lack_of_mat">LACK OF MAT.INCDL.CONS.</option><option value="lack_of_tools">LACK OF TOOLS</option><option value="waiting_for_work">WAITING FOR WORK</option> <option value="failure_of_crane">FAILURE OF CRANE</option> <option value="waiting_for_crane">WAITING FOR CRANE</option><option value="operator_absent">OPERATOR ABSENT</option> <option value="operator_wkg_elsewhere">OPERATOR WORKING ELSEWHERE</option> <option value="lack_of_gas">LACK OF GAS OXY</option><option value="lack_of_grinding_wheel">LACK OF GRINDING WHEEL</option><option value="lack_of_electrodes">LACK OF ELECTRODES</option><option value="waiting_for_lifter">WAITING FOR F./LIFTER</option><option value="drop_in_pressure">DROP IN Pn. PRESSURE</option></select><input type="hidden" id="reasons_for_idle_time{{forloop.counter}}" value="{{i.reasons_for_idle_time}}"></td>'+
'<td  ><input type="text" id='+total_time+' name='+total_time+' placeholder="Total Time" required readonly></td>'+'<td  ><input type="text" id='+idle_time+' name='+idle_time+' placeholder="Idle Time" required></td>';

        htAppend=htAppend+'</tr></table></div>';



     $('#inouttab').append(htAppend);
     document.getElementById("inoutnum").value=j;

    });
    $('body').on('click','#del',function(e){
        $(this).parent('div').remove();
    });

});
function check(th)
{
  var did=th.id;
  var val=document.getElementById(did).value;
  var ck=document.getElementById('cmonth').value;
  console.log(ck);
  if (!isUpperCase(val))
  {
    alert('Month should be in uppercase only!!');
  }
  if(ck.length!=val.length)
  {
      alert('Month should be same as selected above !!');
  }
}
function isUpperCase(str) { return str === str.toUpperCase(); }
function assign(){
        function operation()
        {
        console.log(j);
        return j;
        }
       document.getElementById('myvalue').value =operation();
    }
  </script>



 
    
<script type="text/javaScript">
$( document ).ready(function() {
    // console.log( "ready!" );
    tottime('in11');
});
    // console.log( "ready!" );
    function tottime(id) {
      console.log("id=");
      console.log(id);
      var ad=id.includes("add");
      
      if(ad==false)
      {
      var inn=id.includes("in");
      console.log(inn);
      if(inn)
      {
        var res = id.split("in1");
        console.log(res[1]);
        var outid="#out"+res[1];
    var timeOfCall = $('#'+id).val(),
        timeOfResponse = $(outid).val(),
        hours = timeOfResponse.split(':')[0] - timeOfCall.split(':')[0],
        minutes = timeOfResponse.split(':')[1] - timeOfCall.split(':')[1];

    minutes = minutes.toString().length<2?'0'+minutes:minutes;
    if(minutes<0){ 
        hours--;
        minutes = 60 + minutes;
    }
    hours = hours.toString().length<2?'0'+hours:hours;
    console.log("total_time=",hours + ':' + minutes,'#total_time'+String(res[1]));
    $('#total_time'+String(res[1])).val(hours + ':' + minutes);
      }
      else
      {
      var res = id.split("out");
        console.log(res[1]);
        var inid="#in1"+res[1];
    var timeOfCall = $(inid).val(),
        timeOfResponse = $('#'+id).val(),
        hours = timeOfResponse.split(':')[0] - timeOfCall.split(':')[0],
        minutes = timeOfResponse.split(':')[1] - timeOfCall.split(':')[1];

    minutes = minutes.toString().length<2?'0'+minutes:minutes;
    if(minutes<0){ 
        hours--;
        minutes = 60 + minutes;
    }
    hours = hours.toString().length<2?'0'+hours:hours;
    console.log("total_time=",hours + ':' + minutes,'#total_time'+String(res[1]));

    $('#total_time'+String(res[1])).val(hours + ':' + minutes);
      }
      }
      else{
      var inn=id.includes("in");

        if(inn)
      {
        var res = id.split("in1add");
        console.log(res[1]);
        var outid="#outadd"+res[1];
    var timeOfCall = $('#'+id).val(),
        timeOfResponse = $(outid).val(),
        hours = timeOfResponse.split(':')[0] - timeOfCall.split(':')[0],
        minutes = timeOfResponse.split(':')[1] - timeOfCall.split(':')[1];

    minutes = minutes.toString().length<2?'0'+minutes:minutes;
    if(minutes<0){ 
        hours--;
        minutes = 60 + minutes;
    }
    hours = hours.toString().length<2?'0'+hours:hours;
    console.log("total_time_add=",hours + ':' + minutes,'#total_time_add'+String(res[1]));

    $('#total_time_add'+String(res[1])).val(hours + ':' + minutes);
      }
      else
      {
      var res = id.split("outadd");
        console.log(res[1]);
        var inid="#in1add"+res[1];
    var timeOfCall = $(inid).val(),
        timeOfResponse = $('#'+id).val(),
        hours = timeOfResponse.split(':')[0] - timeOfCall.split(':')[0],
        minutes = timeOfResponse.split(':')[1] - timeOfCall.split(':')[1];

    minutes = minutes.toString().length<2?'0'+minutes:minutes;
    if(minutes<0){ 
        hours--;
        minutes = 60 + minutes;
    }
    hours = hours.toString().length<2?'0'+hours:hours;
    console.log("total_time_add=",hours + ':' + minutes,'#total_time_add'+String(res[1]));

    $('#total_time_add'+String(res[1])).val(hours + ':' + minutes);
      }
      }
    
  }




  
  document.querySelector("#shop_sec").addEventListener('change',(e)=>{
    //console.log("hi");
                    e.preventDefault();
                    var shop_sec = $("#shop_sec").val()
                    var data = {shop_sec};
                      $.ajax({
                        type : 'GET',
                        url : "{% url 'm12getwono' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                          var elementsadded = document.querySelectorAll(".newelewono");
                              if(elementsadded.length>0){
                                  var elementsaddedarr = Array.from(elementsadded);
                                  elementsaddedarr.forEach((el)=> el.remove());
 
                              }
                              var brarr,mystr,html;
                              brarr = response.map((el)=>el.batch_no);
                              mystr = "";
                              brarr.forEach((el,index)=>{
                                html = `<option class="newelestaff">${brarr[index]}</option>`
                                mystr = html.concat(mystr);
                              });
                              html = "";
                              document.querySelector("#wno").insertAdjacentHTML('beforeend',mystr);
                              mystr=""; 
                        }
                          })
                })  
                document.querySelector("#shop_sec").addEventListener('change',(e)=>{
    //console.log("hi");
                    e.preventDefault();
                    var shop_sec = $("#shop_sec").val()
                    var data = {shop_sec};
                      $.ajax({
                        type : 'GET',
                        url : "{% url 'm12getstaff_no' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){
                          var elementsadded = document.querySelectorAll(".newelestaff");
                              if(elementsadded.length>0){
                                  var elementsaddedarr = Array.from(elementsadded);
                                  elementsaddedarr.forEach((el)=> el.remove());
 
                              }
                              var brarr,mystr,html;
                              brarr = response.map((el)=>el.staff_no);
                              mystr = "";
                              brarr.forEach((el,index)=>{
                                html = `<option class="newelestaff">${brarr[index]}</option>`
                                mystr = html.concat(mystr);
                              });
                              html = "";
                              document.querySelector("#staff_no").insertAdjacentHTML('beforeend',mystr);
                              mystr=""; 
                        }
                          })
                })  
                document.querySelector("#staff_no").addEventListener('change',(e)=>{

document.querySelector("#myproceed").click();
})
document.addEventListener('keypress',(event)=>{
if(event.keyCode===13){
    event.preventDefault();
}
})
function printDiv() {
     var printContents = document.getElementById("print").innerHTML;

       var style = "<style>";
        style = style + "table {width: 100%;font: 17px Calibri;}";
        style = style + "table, th, td {border: solid 1px #DDD; border-collapse: collapse;";
        style = style + "padding: 2px 3px;text-align: left;}";
        style = style + "</style>";
      var win = window.open('', '', 'height=500,width=500');

        
        win.document.write('<html><head>');

        win.document.write('<title>M15 Card</title>');
        win.document.write(style);
        win.document.write('</head>');
        win.document.write('<body>');
        win.document.write(printContents);
        win.document.write('</body></html>');
       


        win.print();
        win.close();

}
function find2(th){


var id = th.id;
no=id.split("staff_noadd")
// no1=id.split("ticket_noadd")

var exam_type="staff_nameadd"+no[1];
// var ticket_no="staff_nameadd"+no1[1];
var two=document.getElementById(id).value;
console.log(id+" "+two+" "+exam_type);

var data = {two};
                    $.ajax({
                      type : 'GET',
                      url : "{% url 'm12getempname' %}",
                    
                      dataType : 'json',
                      data : data,
                      success : function(response){
                          console.log(response);
                          // var w=document.getElementById('exam_type')
                          // console.log("w",w)
                       document.getElementById(exam_type).value= response.exam.exam_type;
                       console.log(document.getElementById(exam_type).value)

                     
                       
                      }
                        })
}

function myFunction(th) {
  var id = th.id;
  var x = document.getElementById(id).value;
  // alert("x : "+x)
  console.log("x",id);
  k=id.split("shiftadd");
  console.log("kkk",k)
  if ( document.getElementById(id).value=="A") {
       console.log(document.getElementById(id).value) ;
      //  alert("x1 : "+document.getElementById(id).value)
      //  document.getElementById("in1add"+k[1]).value = "07:27";
       document.getElementById("in1add"+k[1]).min = "06:27";
       document.getElementById("in1add"+k[1]).max = "06:45";


       document.getElementById("outadd"+k[1]).min = "14:30";
       document.getElementById("outadd"+k[1]).max = "14:45";


    }
    if(document.getElementById(id).value=="B")  {
       console.log(document.getElementById(id).value) ;
      //  alert("x1 : "+document.getElementById(id).value)
      //  document.getElementById("inadd"+k[1]).value = "14:27";

       document.getElementById("in1add"+k[1]).min = "14:27";
       document.getElementById("in1add"+k[1]).max = "14:45";
      //  document.getElementById("outadd"+k[1]).value = "22:30";

       document.getElementById("outadd"+k[1]).min = "22:30";
       document.getElementById("outadd"+k[1]).max = "22:45";


    }
    if(document.getElementById(id).value=="C")  {
       console.log(document.getElementById(id).value) ;
      //  alert("x1 : "+document.getElementById(id).value)
      //  document.getElementById("inadd"+k[1]).value = "14:27";

       document.getElementById("in1add"+k[1]).min = "22:27";
       document.getElementById("in1add"+k[1]).max = "22:45";
      //  document.getElementById("outadd"+k[1]).value = "22:30";

       document.getElementById("outadd"+k[1]).min = "06:30";
       document.getElementById("outadd"+k[1]).max = "06:45";


    }
    if(document.getElementById(id).value=="GD")  {
       console.log(document.getElementById(id).value) ;
      //  alert("x1 : "+document.getElementById(id).value)
      //  document.getElementById("inadd"+k[1]).value = "14:27";

       document.getElementById("in1add"+k[1]).min = "06:27";
       document.getElementById("in1add"+k[1]).max = "06:45";
      //  document.getElementById("outadd"+k[1]).value = "22:30";

       document.getElementById("outadd"+k[1]).min = "16:00";
       document.getElementById("outadd"+k[1]).max = "16:30";


    }
    if(document.getElementById(id).value=="GN")  {
       console.log(document.getElementById(id).value) ;
      //  alert("x1 : "+document.getElementById(id).value)
      //  document.getElementById("inadd"+k[1]).value = "14:27";

       document.getElementById("in1add"+k[1]).min = "15:57";
       document.getElementById("in1add"+k[1]).max = "16:15";
      //  document.getElementById("outadd"+k[1]).value = "22:30";

       document.getElementById("outadd"+k[1]).min = "01:30";
       document.getElementById("outadd"+k[1]).max = "01:45";


    }
}

                        

    
 
             </script>   




    

  
  








{% endblock content %}