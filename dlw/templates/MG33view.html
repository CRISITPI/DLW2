{% extends 'base.html' %} {% block content %}
 
<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/css/select2.min.css" rel="stylesheet" /> -->
 
 
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.10/js/select2.min.js"></script>
{% comment %} <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"> {% endcomment %}
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
{% comment %} <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"> {% endcomment %}
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
 
  <script>
    $(document).ready(function () { 
      $('#updt_date').datepicker({dateFormat: 'dd-mm-yy'}); 
      $('#acc_date').datepicker({dateFormat: 'dd-mm-yy'});
      $('#exam_date').datepicker({dateFormat: 'dd-mm-yy'});
      });
  </script>
    
   <meta name="viewport" content="width=device-width, initial-scale=1">
      
<style>

      /* Style the tab */
      .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
        width:120%;
      }
      
      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
      }
      
      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #ddd;
      }
      
      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #ccc;
      }
      
      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
        
      }

   
</style>
<style>
    input[type=text],
    select {
        width: 100%;
        padding: 12px 20px;
        margin: 8px 0;
        display: block;
        border: 0.5px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }
    
    input[type=submit] {
        width: 10%;
        text-align: center;
        background-color: #4CAF50;
        color: white;
        padding: 6px 6px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
    
    input[type=submit]:hover {
        background-color: #45a049;
        text-align: center;
    }
    
    #add {
        width: 30%;
        text-align: center;
        background-color: #4CAF50;
        color: white;
        padding: 6px 6px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .master {
      width: 200px;
      text-align: center;
      background-color: #4CAF50;
      color: white;
      padding: 6px 6px;
      margin: 8px 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
  }


 
    #print {
        width: 10%;
        text-align: center;
        background-color: #4CAF50;
        color: white;
        padding: 6px 6px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    #head{

      background-color:slategrey;
      
      color: white;
    }
    
    input[type=button]:hover {
        background-color: #45a049;
        text-align: center;
    }
 
    .container input:checked ~ .checkmark:after {
                display: inline;
              }
              #customers {
                font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
                border-collapse: collapse;
                margin-left: auto;
                margin-right: auto;
                width: 120%;
                
            }
            
            #customers td,
            #customers th {
                border: 1px solid #ddd;
                padding: 8px;
            }
            
            #customers tr:nth-child(even) {
                background-color: #f2f2f2;
            }

            #customers td{
              background-color: slategrey;
              width: 120%;

            }
            
            /* #customers tr:hover {
                background-color: #ddd;
            } */
            
            #customers th {
                padding-top: 12px;
                padding-bottom: 12px;
                text-align: left;
                background-color:olivedrab;
                color: white;
            }
</style>

 
<form action="{% url 'MG33view' %}" method="POST" enctype="multipart/form-data" onsubmit="return validateForm()">
  {% csrf_token %}
  <div  class="container">
  <br>
  <div class="row">
    <div class="col-md-12"> {% if messages %}
     
          {% for message in messages %}
          
              <h3 class="text-center">
                  {{ message }}
              </h3>
          </font>
          {% endfor %}
      
      {% endif %}</div>
 
  </div>
  <div class="row">
    <div class="col-md-4 text-left">
      <h6  >आई.एस.ओ. - 9002/ I.S.O. - 9002 </h6>  
    <h6  >डी० रे० का (वाराणासी )/ D.L.W. (Varanasi)</h6>
    <h6 >एम. जी. - 33/ M. G. - 33 </h6> 
  </div>

    <div class="col-md-5 text-center">
        <h3>डीजल रेल इंजन कारखाना  - MG33 </h3>
        <h4>शिल्प परीक्षा वृत - Trade Test</h4>
    </div>
    <div class="col-md-3 text-right">
      <a class="btn btn-primary master"     target="_black"  href="/view_exam_data">View Data</a>
      <a class="btn btn-primary master"     target="_black"  href="/examdetail">Trade Test Master Screen</a>
    </div>
     
  </div>
     
    <table   class="table">
         
 
        <td>
           <label for="sno"><b>Shop Section NO/ शॉप अधी..:</b></label>
          <select class="form-control ll" id="shop_sec" name="shop_sec"  onchange="shopsec()"    required>   
          <option   value="" selected disabled hidden>Shop Section</option>  
         
          {% if lenm == 1 %}
            {% for role in roles %}
              <option selected readonly>{{role}}</option>
                {% endfor %}
                {% endif %}
                {% if lenm > 1 %}
                  {% for role in roles %}
                    <option>{{role}}</option>
                  {% endfor %}
                {% endif %}
            </select>
          </td>  

          <td>     
            <label for="sno"><b>S.NO:</b></label>             
            <input type="text" id="exam_sno" class="form-control" name="exam_sno"  required   />
          </td>
           
          <td>
            <label for="sno"><b>Staff Number स्टाफ न:</b></label> 
            <select name='ticketfname' id='ticketfname'  class="form-control"  required > 
             <option value="" selected disabled hidden> Select Name</option> 
          {% for i in workerlist %}
          <option appdate="{{i.updt_date}}" id="{{i.name}}">{{i.staff_no}}</option>
          {% endfor %}
          </td>
          

          
          <td> <label for="sno"><b>Worker Name नाम :</b></label>
             
              <input type="text"  class="form-control"  id="nameoname" name="nameoname"  readonly=""> 
            </td>

            
            
             

            <td>  <label for="sno"><b> Appointment Date/ दिनांक </b></label>            
              <input type="text" id="updt_date" class="form-control"  name="updt_date"   readonly/>
            </td> 
          
          
          <!-- <td><input type="text" id="stffno" name="stffno" value="{{ticketno}}" style="display: none" /></td>     
          <td><input type="text" id="shpsec" value="{{shopsec}}" style="display: none" />
            <input type="submit" name="proceed" value="Add" id="proceed" style="display: none" /></td>      -->
        </tr>

        
    </table>
     
   

<table  class="table">
 
  <th><b>Exam Code</b></th>
  <th><b>Exam Type</b></th>
  <th><b><label for="sno"><b>Date of Exam/ परीक्षा की तिथि:</b></label> </b></th>
  
  <th><b>Exam Place Of Exam:</b> </th>  
  <th><b>Exam Designation</b></th>
  <th><b>Exam Department</b></th>

  <tr> 
  <td>           
        <select class="form-control" id="exam_code" name="exam_code" style="width: 150px;" onclick="exam_detail(this)" required>
                <option  value=""  selected disabled hidden>Exam Code</option> 
          
              {% for ex in examcode %}
              <option value="{{ex}}">{{ex}}</option>
              {% endfor %}
 
              </select>
         </td>
         <td>
           
            <input id="exam_type" type="text" name="exam_type" class="form-control" placeholder="Exam Type" readonly>
         </td>         
         <td>     
                      
          <input type="text" id="exam_date" class="form-control" name="exam_date" placeholder="dd-mm-yyyy"    required />
        </td>
         <td>
         
          <select class="form-control ll" name="place"   required>
            <option>DLW</option>
            <option>Other</option>
            <option>Other</option>
            
          </select>  
        </td>
           <td>
            <input id="designation" type="text" name="designation" class="form-control" placeholder="Designation" readonly>
         </td>
         <td>
           
            <input id="department" type="text" name="department" class="form-control" placeholder="Department name" readonly>
         </td>


  </tr>

</table>
  
 
    <table   class="table">
        <tr>
        <th>Skill</th>
        <th>Practical Description</th>
        <th>Practical Score</th>
        <th>Oral Description</th>
        <th>Oral Score</th> 
        <th>Attachment File</th>
        </tr>
        <tr> 
        <td><select class="form-control" id='skillname'  name='skillname'  required>
          <option value="Skilled">Skilled</option>
          <option value="Un-Skilled">Un-Skilled</option>
          <option value="Un-Skilled">Core</option></select></td>
          <td><textarea   class="form-control" id="pracdesc"  name="pracdesc"    >  </textarea></td>
          <td><input type="number" class="form-control" id="prac"  maxlength="3"  name="prac" required ></td>
          <!-- name="oraldescr" onblur="javascript:addNumbers()"  -->
        <td><textarea  class="form-control" id="oraldescr"  name="oraldescr"    ></textarea></td>
        <td> <input type="number" class="form-control" id="orscore"  maxlength="3" name="orscore"  name="oraldescr"   required  ></td>
        <td> <input type="file" class="form-control" id="attachment"   name="attachment"  required></td>
        </tr> 
      </table>
 
          
         <table   class="table">
           <tr>
            <td> <label for="pramedak"><b>Pramedak NO  :</b></label>             
              <input type="text"  class="form-control"  id="pramedakno" name="pramedakno"  required   > 
            </td>
            <td>
              <label for="sec_sup"><b>Subordinate Supervisor-अधीनस्थ पर्यवेक्षक :</b></label>
              <select class="form-control ll" id="sec_sup" name="sec_sup"  required>
                <option   value= "" selected disabled hidden>Section Supervisor</option> 
                
                {% for i in empname %}
                <option des="{{i.desig_longdesc}}" id="{{i.empname}}" value="{{i.empno}}">{{i.empno}}</option>
                {% endfor %}
                </select>
                <br>
               <h6 id="sub_name"> </h6>
               <h6 id="sub_des"> </h6>
  
            </td>
             <td>
                <label for="trade_test_officer"><b>Trade Test Officer</b></label>
 
              <select class="form-control ll" id="trade_test_officer" name="trade_test_officer"    required>
              <option    value="" selected disabled hidden>Trade Test Officer</option> 
              
                  {% for i in empname %}
                  <option des="{{i.desig_longdesc}}" id="{{i.empname}}" value="{{i.empno}}">{{i.empno}}</option>
                  {% endfor %}
              </select>
              <br>
               <h6 id="officer_name">  </h6>
               <h6 id="officer_des"> </h6>
             </td>
 
             <td>
 
                <label  for="foreman"><b>Foreman/ Trade Test</b></label>
 
                <select class="form-control ll" id="foreman" name="foreman"   required>
                <option   value=""  selected disabled hidden>Foreman/ Trade Test</option> 
                  {% for i in empname %}
                  <option des="{{i.desig_longdesc}}" id="{{i.empname}}" value="{{i.empno}}">{{i.empno}}</option>
                  {% endfor %}
                  </select>
                  <br>
                  <h6 id="foreman_name"> </h6>
                  <h6 id="foreman_des"> </h6>
             </td>

             <td>

                <label  for="trade_test_admin"><b>Trade Test Admin</b></label>
                <select class="form-control ll" id="ssfo" name="trade_test_admin"   required>                    
                 <option   value=""   selected disabled hidden >शिल्प परीक्षा नायिका</option> 
                      {% for i in empname %}
                     <option des="{{i.desig_longdesc}}" id="{{i.empname}}" value="{{i.empno}}">{{i.empno}}</option>
                      {% endfor %}
                        </select> 
                        <br>
                        <h6 id="admin_name"> </h6>
                        <h6 id="admin_des"> </h6>
                </td>

              </tr>

            </table>

      

<center>

  <input id="submit" type="submit" name="proceed" value="Save" id="submitted"> 
  <!-- <input id="print" type="button" onclick="printDiv()" value="Print">  -->
</center>
  
</div>
</div>
</form>
 
<script>


// $("#submitted").change(function() { 
  
//   alert()
//   var sno = $("#exam_sno").val();
//   if (sno == "") {
//     alert("Sno must be filled out");
//     return false;
//   }
// }


</script>
<script type="text/javaScript">
$(document).ready(function () {
   $('#acc_date').datepicker({dateFormat: 'yy-mm-dd'}); });

$("#ticketfname").change(function() {  
  var shop_sec = $("#ticketfname").val();
  var shop_name = $('#ticketfname option:selected').attr('id');  
  var appdate = $('#ticketfname option:selected').attr('appdate'); 

  //appdate = new Date(Date.parse(appdate)).format("yyyy-mm-dd")

  //alert(appdate)
  $("#nameoname").val(shop_name);
  $("#updt_date").val($.date(appdate));
 

});

$("#prac").change(function() {  
  var total = $("#prac").val().length; 
//alert(total)
  if((total== 2) || (total== 1)){
  
    }else{      
    $("#prac").val(0)
     alert(" Practical Score  Enter maximum two number.")
  
  return false;
    }
  
});


$("#orscore").change(function() {  
  var total = $("#orscore").val().length; 
    // alert(total)
  if((total== 2) || (total== 1)){
  
    }else{      
    $("#orscore").val(0)
      alert("Oral Score Enter  maximum two number.")
  
  return false;
    }
  
});

$.date = function(dateObject) {
    var d = new Date(dateObject);
    var day = d.getDate();
    var month = d.getMonth() + 1;
    var year = d.getFullYear();
    if (day < 10) {
        day = "0" + day;
    }
    if (month < 10) {
        month = "0" + month;
    }
    var date = day + "-" + month + "-" + year;

    return date;
};
 
function shopsec(){
  var shop_sec = $("#shop_sec").val()
  //alert(shop_sec)
  var data = {shop_sec};
    $.ajax({
      type : 'GET',
      url : "{% url 'mg33getstaffdetails' %}",
      dataType : 'json',
      data : data,
      success : function(response){
        console.log(response);

    // alert(response.data.length)
     //alert(response.data[0].staff_no)
  
    var mystr = "";
    var html="";
      for (var i = 0; i < response.data.length; i++) {
        html = '<option appdate='+response.data[i].updt_date+' id='+response.data[i].name+' >'+response.data[i].staff_no+'</option>';
        mystr = html.concat(mystr);
        } 
      document.querySelector("#ticketfname").insertAdjacentHTML('beforeend',mystr);
      mystr="";
      html = "";

        //document.getElementById('ticketfname').value= response.data[0].staff_no;
        
      }
                        })
  //document.querySelector("#proceed").click();
 }

  $("#sec_sup").change(function() {  
 
  var sup_name = $('#sec_sup option:selected').attr('id');  
  var sup_des = $('#sec_sup option:selected').attr('des');
   
    $("#sub_name").text(sup_name);
    $("#sub_des").text(sup_des);
  })

  $("#trade_test_officer").change(function() {  
 
 var sup_name = $('#trade_test_officer option:selected').attr('id');  
 var sup_des = $('#trade_test_officer option:selected').attr('des');
  
   $("#officer_name").text(sup_name);
   $("#officer_des").text(sup_des);
 })
 

 $("#foreman").change(function() {  
 
 var sup_name = $('#foreman option:selected').attr('id');  
 var sup_des = $('#foreman option:selected').attr('des');
  
   $("#foreman_name").text(sup_name);
   $("#foreman_des").text(sup_des);
 })

 $("#ssfo").change(function() {  
 
 var sup_name = $('#ssfo option:selected').attr('id');  
 var sup_des = $('#ssfo option:selected').attr('des');
  
   $("#admin_name").text(sup_name);
   $("#admin_des").text(sup_des);
 })
// $("#shop_sec").change(function() {  

// // var updt_date_temp = $("#updt_date").val()

// // if(updt_date_temp == "dd-mm-yy"){
// //   alert("Please First select Date then Shop Section.")
// // return false;
// //   }

  
// })


function exam_detail(th){
//alert(0)

var id = th.id;
var two=document.getElementById(id).value;

var data = {two};
                    $.ajax({
                      type : 'GET',
                      url : "{% url 'mg33getexam' %}",
                      dataType : 'json',
                      data : data,
                      success : function(response){
                       console.log(response);
                       document.getElementById('exam_type').value= response.exam.exam_type;
                       //document.getElementById('exam_date').value= response.exam.exam_date;
                       document.getElementById('designation').value= response.exam.designation;
                       document.getElementById('department').value= response.exam.department;

                      }
                        })

}

 
$( function() {
              $( ".datepicker2" ).datepicker({
                dateFormat:'yy-mm-dd',
                changeMonth:true,
                changeYear:true,
                yearRange:"2009:2099"
              }).val;
            } );
 
 
  var j=0;
  var prac="prac";
  var oral="oral";
  var total="total";
  var remk="remk";
   


    function addNumbers()
    {
            console.log(prac,oral);
            //var total= parseInt(document.getElementById(total).value);
            var val1 = parseInt(document.getElementById(prac).value);
            var val2 = parseInt(document.getElementById(oral).value);
            var temp=val1+val2;
            if (val1>60 || val2 >40){
              alert("Please enter valid score for practical and oral score ");              
            }

       
            else{
              var ansD = document.getElementById(total);
              ansD.value = val1 + val2;
            
            if (temp>=55)
            {
              document.getElementById(remk).value="PASS";
            }
            else
            {
              document.getElementById(remk).value="FAIL";
            }
          }
            
    }


   



 
// function find(th)
//   {
//   var id = th.id;
//   var two=id.split("name");
//   var ticket="ticket"+two[1];
//   var name=document.getElementById(id).value;
//   var shop_sec=document.getElementById('shpsec').value;
 
 
 
//   var data = {shop_sec,name};
//                       $.ajax({
//                         type : 'GET',
//                         url : "{% url 'mg33getstaffno' %}",
//                         dataType : 'json',
//                         data : data,
//                         success : function(response){
//                             console.log(response);
//                          document.getElementById(ticket).value= response.cont.wono;

//                         }
//                           })
 
 
//        }
        
      

    function printDiv() {
      var printContents = document.getElementById("printdata").innerHTML;
 
        var style = "<style>";
         style = style + "table {width: 100%;font: 17px Calibri;}";
         style = style + "table, th, td {border: solid 1px #DDD; border-collapse: collapse;";
         style = style + "padding: 2px 3px;text-align: left;}";
         style = style + "</style>";
       var win = window.open('', '', 'height=500,width=500');
 
         win.document.write('<html><head>');
 
         win.document.write('<title>Trade Test - DLW</title>');
         win.document.write(style);
         win.document.write('</head>');
         win.document.write('<body>');
         win.document.write(printContents);
         win.document.write('</body></html>');
 
         win.print();
         win.close();
 
 
 }

</script>    
{% endblock content %}