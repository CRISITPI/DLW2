{% extends 'base.html' %} {% block content %}
<html lang="en">
  <head>
    <script>
      $(document).ready(function () {
        $("#date").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#editdate").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#inspect_date").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#dispatch_date").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#in_qty").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#out_qty").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#editin_qty").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
    <script>
      $(document).ready(function () {
        $("#editout_qty").datepicker({
          dateFormat: "dd-mm-yy",
          maxDate: "0",
        });
      });
    </script>
  </head>

  <style>
    #customers {
      font-family: "Quicksand", sans-serif;
      border-collapse: collapse;
      margin-left: auto;
      margin-right: auto;
      width: 100%;
    }

    #customers td,
    #customers th {
      border: 1px solid #ddd;
      padding: 8px;
    }
  </style>
  <style>
    @import url("https://fonts.googleapis.com/css?family=Quicksand&display=swap");

    body {
      font-family: "Quicksand", sans-serif;
      height: 100%;
      margin: 0;
    }
    html {
      height: 100%;
      margin: 0;
    }
    .page-content {
      min-height: 100%;
      margin-bottom: -40px;
    }
    .page-content::after {
      content: "";
      display: block;
    }
    footer,
    .page-content::after {
      height: 40px;
    }
    .content_section {
      width: 60%;
    }
  </style>

  <form action="." id="myForm" method="POST" novalidate>
    {% csrf_token %}

    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
      <ul class="navbar nav" style="width: 60%;">
        <font size="4pt" color="#FFFFFF">Pinion Pressing Section</font>
      </ul>

      <div class="collapse navbar-collapse" id="collapse_target">
        <ul class="navbar nav" style="width: 100%;">
          <li class="nav-item">
            <button
              type="button"
              class="btn btn-primary"
              data-toggle="modal"
              data-target="#DeleteModal"
              style="
                background: none;
                font-size: 12pt;
                margin-top: 2%;
                margin-left: 2%;
              "
            >
              <font color="white">Delete</font>
            </button>
          </li>

          <li class="nav-item">
            <button
              type="button"
              class="btn btn-primary"
              data-toggle="modal"
              data-target="#InspectModal"
              style="
                background: none;
                font-size: 12pt;
                margin-top: 2%;
                margin-left: 2%;
              "
            >
              <font color="white">Inspect</font>
            </button>
          </li>
          <li class="nav-item">
            <button
              type="button"
              class="btn btn-primary"
              data-toggle="modal"
              data-target="#EditModal"
              style="
                background: none;
                font-size: 12pt;
                margin-top: 2%;
                margin-left: 2%;
              "
            >
              <font color="white">EditRecord</font>
            </button>
          </li>
          <li class="nav-item">
            <button
              type="button"
              class="btn btn-primary"
              data-toggle="modal"
              data-target="#AddModal"
              style="
                background: none;
                font-size: 12pt;
                margin-top: 2%;
                margin-left: 2%;
              "
            >
              <font color="white">AddRecord</font>
            </button>
          </li>
        </ul>
      </div>
    </nav>
    <table id="customers">
      <tbody>
        <tr>
          <center>
            {% if messages %}
            <ul class="messages">
              {% for message in messages %}
              <font size="3">
                <li>
                  <h4>{{ message }}</h4>
                </li>
              </font>
              {% endfor %}
            </ul>
            {% endif %}
          </center>
        </tr>
        <tr>
          <th>Serial No.&nbsp;</th>
          <th>Batch Order No.&nbsp;</th>
          <th>Part No. &nbsp;</th>
          <th>Batch Qty &nbsp;</th>
          <th>Batch Order Date</th>
          <th>Loco Type &nbsp;</th>
          <th>Date &nbsp;</th>
          <th>In Quantity &nbsp;</th>
          <th>Out Quantity &nbsp;</th>
          <th>Traction Motor No.</th>
          <th>Traction Motor Make</th>
          <th>Axle No.</th>
          <th>Inspection Status</th>
          <th>Inspection Date &nbsp;</th>
        </tr>
        {% for objec in object %}
        <tr>
          <td>{{objec.sno}} <br /></td>
          <td>{{objec.bo_no}} <br /></td>
          <td>{{objec.pt_no}} <br /><br /></td>
          <td>{{objec.bo_qty}} <br /><br /></td>
          <td>{{objec.bo_date}} <br /></td>
          <td>{{objec.loco_type}} <br /></td>
          <td>{{objec.date}} <br /></td>
          <td>{{objec.in_qty}} <br /><br /></td>
          <td>{{objec.out_qty}} <br /><br /></td>
          <td>{{objec.tm_no}} <br /></td>
          <td>{{objec.tm_make}} <br /></td>
          <td>{{objec.axle_no}} <br /></td>
          <td>{{objec.dispatch_to}} <br /><br /></td>
          <td>{{objec.inspect_date}} <br /><br /></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <input type="hidden" name="once" id="once" value="0" />

    <!-- Modal -->
    <div
      class="modal fade"
      id="AddModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Pinion Pressing</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form method="POST" class="needs-validation">
            {% csrf_token %}
            <div class="modal-body">
              <div class="row">
                <div class="col-6">
                  <label for="">Batch Order No.</label>
                  <select
                    name="bo_no"
                    id="addbono"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected>Select BO No.</option>
                    {% for x in mybo %}
                    <option>{{x.bo_no}}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="col-6">
                  <h6><label for="">Batch Order Date</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="bo_date"
                    id="bo_date"
                    placeholder="yyyy-mm-dd"
                    required
                    readonly
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-6">
                  <label>Part No.</label>
                  <input
                    type="text"
                    class="form-control"
                    name="pt_no"
                    id="pt_no"
                    required
                    readonly
                  />
                </div>
                <div class="col-6">
                  <label>Batch Qty</label>
                  <input
                    type="text"
                    class="form-control"
                    name="bo_qty"
                    id="bo_qty"
                    required
                    readonly
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-6">
                  <h6><label for="">Loco Type</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="locos"
                    id="locos"
                    placeholder="loco type"
                    required
                    readonly
                  />
                </div>
                <div class="col-6">
                  <label for="">Date</label>
                  <input
                    type="text"
                    name="date"
                    id="date"
                    class="form-control"
                    placeholder="dd-mm-yyyy"
                    required
                    readonly
                  />
                </div>
              </div>

              <div class="row">
                <div class="col-6">
                  <label for="">Traction motor No.</label>
                  <input
                    type="text"
                    class="form-control"
                    name="tm_no"
                    id="tm_no"
                    placeholder="TM no"
                    maxlength="20"
                    required
                  />
                </div>

                <div class="col-6">
                  <label for="">Traction motor Make</label>
                  <select
                    name="tm_make"
                    id="tm_make"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected
                      >Select Traction motor Make.</option
                    >
                    <option>CGL</option>
                    <option>BHEL</option>
                    <option>SAINI</option>
                    <option>MEDHA</option>
                    <option>EMD</option>
                    <option>SIMENS</option>
                    <option>CHINA</option>
                  </select>
                </div>
              </div>
              <div class="row">
                <div class="col-6">
                  <label for="">Axle No.</label>
                  <select
                    name="axle_no"
                    id="axle_no"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected>Select Axle No.</option>
                    {% for x in axleno %}
                    <option>{{x.axle_no}}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="col-6">
                  <label for="">Machine In Date</label>
                  <input
                    type="text"
                    class="form-control"
                    name="in_qty"
                    id="in_qty"
                    placeholder="dd-mm-yyyy"
                    readonly
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-6">
                  <label for="">Machine Out Date</label>
                  <input
                    type="text"
                    class="form-control"
                    name="out_qty"
                    id="out_qty"
                    placeholder="dd-mm-yyyy"
                    readonly
                  />
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
              <input
                type="submit"
                name="submit"
                class="btn btn-primary"
                id="savebtn"
                value="Save"
                onclick="return funct()"
              />
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--EditRecord-->
    <!-- Modal -->
    <div
      class="modal fade"
      id="EditModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel1"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel1">Pinion Pressing</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <form method="POST" class="needs-validation">
            {% csrf_token %}
            <div class="modal-body">
              <div class="row">
                <div class="col-6">
                  <label for="">Traction Motor No.</label>
                  <select
                    name="sno"
                    id="editsno"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected
                      >Select Traction Motor No.</option
                    >
                    {% for y in mytm %}
                    <option>{{ y.tm_no }}</option>
                    {% endfor %}
                  </select>
                </div>

                <div class="col-6">
                  <h6><label for="">Batch Order No.</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="editbo_no"
                    id="editbo_no"
                    required
                    readonly
                  />
                </div>
                <div class="col-6">
                  <h6><label for="">Batch Order Date</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="editbo_date"
                    id="editbo_date"
                    required
                    readonly
                  />
                </div>

                <div class="col-6">
                  <h6><label>Part No.</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="editpt_no"
                    id="editpt_no"
                    required
                    readonly
                  />
                </div>
                <div class="col-6">
                  <h6><label>Batch Qty</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="editbo_qty"
                    id="editbo_qty"
                    required
                    readonly
                  />
                </div>

                <div class="col-6">
                  <h6><label for="">Loco Type</label></h6>
                  <input
                    type="text"
                    class="form-control"
                    name="editlocos"
                    id="editlocos"
                    required
                    readonly
                  />
                </div>

                <div class="col-6">
                  <label for="">Date</label>
                  <input
                    type="text"
                    id="editdate"
                    name="editdate"
                    class="form-control"
                    placeholder="dd-mm-yyyy"
                    required
                    readonly
                  />
                </div>
                <div class="col-6">
                  <label for="">Traction motor No.</label>
                  <input
                    type="text"
                    class="form-control"
                    id="edittm_no"
                    name="edittm_no"
                    placeholder="TM no."
                    maxlength="20"
                    required
                  />
                </div>

                <div class="col-6">
                  <label for="">Traction motor Make</label>
                  <select
                    name="edittm_make"
                    id="edittm_make"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected
                      >Select Traction motor Make.</option
                    >
                    <option>CGL</option>
                    <option>BHEL</option>
                    <option>SAINI</option>
                    <option>MEDHA</option>
                    <option>EMD</option>
                    <option>SIMENS</option>
                    <option>CHINA</option>
                  </select>
                </div>
                <div class="col-6">
                  <label for="">Machine In Date</label>
                  <input
                    type="text"
                    class="form-control"
                    name="editin_qty"
                    id="editin_qty"
                    placeholder="dd-mm-yyyy"
                    readonly
                  />
                </div>
                <div class="col-6">
                  <label for="">Machine Out Date</label>
                  <input
                    type="text"
                    class="form-control"
                    name="editout_qty"
                    id="editout_qty"
                    placeholder="dd-mm-yyyy"
                    readonly
                  />
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
              <input
                type="submit"
                name="submit"
                class="btn btn-primary"
                id="editsavebtn"
                value="Edit"
                onclick="return editfunct()"
              />
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--Dispatch-->
    <!-- Modal -->
    <div
      class="modal fade"
      id="DispatchModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel2"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel2">Pinion Pressing</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form method="POST" class="needs-validation">
            {% csrf_token %}
            <div class="modal-body">
              <div class="row">
                <div class="col-6">
                  <label for="">Serial No.</label>
                  <input
                    type="number"
                    class="form-control"
                    id="dissno"
                    name="dissno"
                    required
                  />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-6">
                  <label for="">Dispatch Date(Manually)</label>
                  <input
                    type="text"
                    name="dispatch_date"
                    id="dispatch_date"
                    class="form-control"
                    placeholder="dd-mm-yyyy"
                    required
                    readonly
                  />
                </div>
              </div>
              <br />
              <div class="row">
                <div class="col-6">
                  <div class="dropdown">
                    <select name="dislocos" type="form-control ll" required>
                      <option value="" hidden selected>Dispatch To</option>
                      <option value="AxleWheel Pressing"
                        >Axle & Wheel Pressing Section</option
                      >
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
              <input
                type="submit"
                name="submit"
                class="btn btn-primary"
                id="dissavebtn"
                value="Dispatch"
              />
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--Inspect Wheel-->
    <!--modal-->
    <div
      class="modal fade bd-example-modal-lg"
      id="InspectModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="myLargeModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">
              Pinion Pressing Inspection
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <form
            name="PinionForm"
            id="PinionForm"
            method="POST"
            class="needs-validation"
          >
            {% csrf_token %}

            <div class="modal-body">
              <div class="row">
                <div class="col-6">
                  <label for="">Traction Motor No.</label>
                  <select
                    name="snowheel"
                    id="addsno"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected>Select Traction Motor No.</option>
                    
                    {% for x in mytm %}
                    <option>{{x.tm_no}}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="col-6">
                  <label for="">Pinion No.</label>
                  <input
                    type="text"
                    class="form-control"
                    name="pinion_no"
                    id="pinion_no"
                    placeholder=""
                    maxlength="20"
                    required
                  />
                </div>

                <div class="col-6">
                  <label for="">Pinion Make</label>
                  <select
                    name="pinion_make"
                    id="pinion_make"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected
                      >Select Pinion Make.</option
                    >
                    <option>SHANTHI</option>
                    <option>BHEL</option>
                    <option>GGAG</option>
                    <option>TRINA</option>
                  </select>
                </div>
                <div class="col-6">
                  <label for="">Pinion Travel</label>
                  <input
                    type="text"
                    class="form-control"
                    name="pinion_travel"
                    id="pinion_travel"
                    onchange="validatePinionForm(this.id)"
                    placeholder=""
                    maxlength="20"
                    required
                  />
                </div>
                <div class="col-6">
                  <label for="">Pinion Pressure (Triangle Glycerin)</label>
                  <input
                    type="text"
                    class="form-control"
                    id="pinion_pressure_triangle_glycerin"
                    onchange="validatePinionForm(this.id)"
                    name="pinion_pressure_triangle_glycerin"
                    placeholder=""
                    maxlength="20"
                    required
                  />
                </div>
                <div class="col-6">
                  <label for="">Pinion Pressure (Square RAM)</label>
                  <input
                    type="text"
                    class="form-control"
                    id="pinion_pressure_square_ram"
                    onchange="validatePinionForm(this.id)"
                    name="pinion_pressure_square_ram"
                    placeholder=""
                    maxlength="20"
                    required
                  />
                </div>
                <div class="col-6">
                  <label for="">Distance between Pinion Teeth and DE</label>
                  <input
                    type="text"
                    class="form-control"
                    id="pinion_teeth_dist"
                    onchange="validatePinionForm(this.id)"
                    name="pinion_teeth_dist"
                    placeholder=""
                    maxlength="20"
                    required
                  />
                </div>
                <div class="col-6">
                  <label for="">Blue matching status</label>
                  <input
                    type="text"
                    class="form-control"
                    name="blue_match"
                    id="blue_match"
                    placeholder=""
                    maxlength="20"
                    required
                  />
                </div>
                <div class="col-6">
                  <label for="">Date(Manually)</label>
                  <input
                    type="text"
                    name="inspect_date"
                    id="inspect_date"
                    class="form-control"
                    placeholder="dd-mm-yyyy"
                    required
                    readonly
                  />
                </div>
                <div class="col-6">
                  <input
                    type="hidden"
                    class="form-control"
                    name="hide"
                    id="hide"
                    placeholder=""
                  />
                </div>
              </div>
            </div>

            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
              <input
                type="submit"
                name="submit"
                class="btn btn-primary"
                id="savebtn"
                value="Inspect"
              />
            </div>
          </form>
        </div>
      </div>
    </div>

    <!--Delete-->
    <!-- Modal -->
    <div
      class="modal fade"
      id="DeleteModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel3"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel3">Pinion Pressing</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form method="POST" class="needs-validation">
            {% csrf_token %}
            <div class="modal-body">
              <div class="row">
                <div class="col-6">
                  <label for="">Traction Motor No.</label>
                  <select
                    name="delsno"
                    id="delsno"
                    class="form-control ll"
                    required
                  >
                    <option value="" hidden selected
                      >Select Traction Motor No.</option
                    >
                    {% for x in mytm %}

                    <option>{{x.tm_no}}</option>
                    {% endfor %}
                  </select>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
              <input
                type="submit"
                name="submit"
                class="btn btn-primary"
                id="delsavebtn"
                value="Delete"
              />
            </div>
          </form>
        </div>
      </div>
    </div>
  </form>
  <script>
    $("#addsno").change(function (e) {
      e.preventDefault();
      var val_loco;
      var sels_no1 = $(this).val();
      var data = { sels_no1 };
      $.ajax({
        type: "GET",
        url: "{% url 'validate_pinionpress_inspect' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          $("#hide").val(`${response[0].loco_type}`);
        },
      });
    });

    $("#addbono").change(function (e) {
      e.preventDefault();
      var selbo_no = $(this).val();
      var data = { selbo_no };
      $.ajax({
        type: "GET",
        url: "{% url 'pinion_addbo' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          var d = response[0].rel_date;
          if (d != null && d != "") {
            var month1 = d.substring(5, 7);
            var day1 = d.substring(8, 10);
            var year1 = d.substring(0, 4);
            var date1 = day1 + "-" + month1 + "-" + year1;
            $("#bo_date").val(`${date1}`);
          } else {
            $("#bo_date").val(`${response[0].rel_date}`);
          }

          $("#pt_no").val(`${response[0].part_no}`);
          $("#bo_qty").val(`${response[0].batch_qty}`);
          func1(selbo_no);
        },
      });
    });

    function func1(batch) {
      var selbo_no = batch;
      var data = { selbo_no };
      $.ajax({
        type: "GET",
        url: "{% url 'airbox_addloco' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          $("#locos").val(`${response[0].alpha_1}`);
        },
      });
    }

    $("#tm_no").change(function (e) {
      e.preventDefault();
      var tm_no = $(this).val();
      var data = { tm_no };
      $.ajax({
        type: "GET",
        url: "{% url 'uniquetm' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          if (response == "false") {
            alert(
              "This Traction Motor No. already exists. Please Enter a unique Traction Motor No.!"
            );
            document.getElementById("tm_no").value = "";
          }
        },
      });
    });

    $("#edittm_no").change(function (e) {
      e.preventDefault();
      var tm_no = $(this).val();
      var data = { tm_no };
      $.ajax({
        type: "GET",
        url: "{% url 'uniquetm' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          if (response == "false") {
            alert(
              "This Traction Motor No. already exists. Please Enter a unique Traction Motor No.!"
            );
            document.getElementById("edittm_no").value = "";
          }
        },
      });
    });

    function funct() {
      if (
        document.getElementById("axle_no").value == "" ||
        document.getElementById("tm_make").value == "" ||
        document.getElementById("tm_no").value == "" ||
        document.getElementById("in_qty").value == "" ||
        document.getElementById("out_qty").value == "" ||
        document.getElementById("date").value == ""
      ) {
        alert("Please enter all the fields.");
        return false;
      }
    }
    
    function editfunct() {
      if (
        document.getElementById("editaxle_no").value == "" ||
        document.getElementById("edittm_make").value == "" ||
        document.getElementById("edittm_no").value == "" ||
        document.getElementById("editin_qty").value == "" ||
        document.getElementById("editout_qty").value == "" ||
        document.getElementById("editdate").value == ""
      ) {
        alert("Please enter all the fields.");
        return false;
      }
    }

    $("#pinion_no").change(function (e) {
      e.preventDefault();
      var pinion_no = $(this).val();
      var data = { pinion_no };
      $.ajax({
        type: "GET",
        url: "{% url 'uniquepinion' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          if (response == "false") {
            alert(
              "This Pinion No. already exists. Please Enter a unique Pinion No.!"
            );
            document.getElementById("pinion_no").value = "";
          }
        },
      });
    });

    $("#editsno").change(function (e) {
      e.preventDefault();
      var sels_no = $(this).val();
      var data = { sels_no };
      $.ajax({
        type: "GET",
        url: "{% url 'pinion_editsno' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          console.log(response);
          var indate = response[0].in_qty;

          var outdate = response[0].out_qty;

          if (indate != null) {
            var month1 = indate.substring(5, 7);
            var day1 = indate.substring(8, 10);
            var year1 = indate.substring(0, 4);
            var date1 = day1 + "-" + month1 + "-" + year1;
            $("#editin_qty").val(date1);
          } else {
            $("#editin_qty").val(`${response[0].in_qty}`);
          }
          if (outdate != null) {
            var month2 = outdate.substring(5, 7);
            var day2 = outdate.substring(8, 10);
            var year2 = outdate.substring(0, 4);
            var date2 = day2 + "-" + month2 + "-" + year2;
            $("#editout_qty").val(date2);
          } else {
            $("#editout_qty").val(`${response[0].out_qty}`);
          }
          $("#editbo_no").val(`${response[0].bo_no}`);
          $("#editbo_date").val(`${response[0].bo_date}`);
          $("#editpt_no").val(`${response[0].pt_no}`);
          $("#editbo_qty").val(`${response[0].bo_qty}`);
          $("#editdate").val(`${response[0].date}`);
          $("#edittm_make").val(`${response[0].tm_make}`);
          $("#edittm_no").val(`${response[0].tm_no}`);

          var locodes = document.getElementById("editbo_no").value;
          func2(locodes);
        },
      });
    });

    function func2(batch) {
      var batchNo = batch;
      var data = { batchNo };
      $.ajax({
        type: "GET",
        url: "{% url 'airbox_addeditloco' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          $("#editlocos").val(`${response[0].alpha_1}`);
        },
      });
    }

    $("#addsno").change(function (e) {
      e.preventDefault();
      var sels_no = $(this).val();
      var data = { sels_no };
      $.ajax({
        type: "GET",
        url: "{% url 'FetchPinionInspectDetail' %}",
        dataType: "json",
        data: data,
        success: function (response) {
          if (response == "false") {
            document.getElementById("pinion_make").value = "";
            document.getElementById("pinion_pressure_triangle_glycerin").value =
              "";
            document.getElementById("pinion_pressure_square_ram").value = "";
            document.getElementById("pinion_teeth_dist").value = "";
            document.getElementById("pinion_travel").value = "";
            document.getElementById("blue_match").value = "";
            document.getElementById("pinion_no").value = "";
            document.getElementById("inspect_date").value = "";
          } else {
            var inspectdate = response[0].inspect_date;
            if (inspectdate != null) {
              var month2 = inspectdate.substring(5, 7);
              var day2 = inspectdate.substring(8, 10);
              var year2 = inspectdate.substring(0, 4);
              var date2 = day2 + "-" + month2 + "-" + year2;
              $("#inspect_date").val(date2);
            } else {
              $("#inspect_date").val(`${response[0].inspect_date}`);
            }

            $("#pinion_make").val(`${response[0].pinion_make}`);
            $("#pinion_pressure_triangle_glycerin").val(
              `${response[0].pinion_pressure_triangle_glycerin}`
            );
            $("#pinion_travel").val(`${response[0].pinion_travel}`);
            $("#blue_match").val(`${response[0].blue_match}`);
            $("#pinion_pressure_square_ram").val(
              `${response[0].pinion_pressure_square_ram}`
            );
            $("#pinion_teeth_dist").val(`${response[0].pinion_teeth_dist}`);
            $("#pinion_no").val(`${response[0].pinion_no}`);
          }
        },
      });
    });

    function validatePinionForm(a) {
      var myval = document.getElementById("hide").value;
      var x = document.forms["PinionForm"][a].value;
      if (isNaN(x) == false) {
        if (a == "pinion_travel") {
          if (myval == "WAP-7" || myval == "WAP-9") {
            b = 11.9;
            c = 12.1;
            var relax = 10;
            var min = b - (relax / 100) * b;
            var max = c + (relax / 100) * c;

            if (x < min || x > max) {
              setvalidation1(a, b, c);
            } else if ((x >= min && x < b) || (x > c && x <= max)) {
              setvalidation2(a);
            } else if (x >= b && x <= c) {
              setvalidation3(a);
            }
          }
        }
        if (a == "pinion_pressure_triangle_glycerin") {
          if (myval == "WAP-7" || myval == "WAP-9") {
            b = 24.5;
            c = 29;
            var relax = 10;
            var min = b - (relax / 100) * b;
            var max = c + (relax / 100) * c;

            if (x < min || x > max) {
              setvalidation1(a, b, c);
            } else if ((x >= min && x < b) || (x > c && x <= max)) {
              setvalidation2(a);
            } else if (x >= b && x <= c) {
              setvalidation3(a);
            }
          }
        }
        if (a == "pinion_pressure_square_ram") {
          if (myval == "WAP-7" || myval == "WAP-9") {
            b = 1;
            c = 8;
            var relax = 10;
            var min = b - (relax / 100) * b;
            var max = c + (relax / 100) * c;

            if (x < min || x > max) {
              setvalidation1(a, b, c);
            } else if ((x >= min && x < b) || (x > c && x <= max)) {
              setvalidation2(a);
            } else if (x >= b && x <= c) {
              setvalidation3(a);
            }
          }
        }
        if (a == "pinion_teeth_dist") {
          if (myval == "WAP-7" || myval == "WAP-9") {
            b = 3;
            c = 5;
            var relax = 10;
            var min = b - (relax / 100) * b;
            var max = c + (relax / 100) * c;

            if (x < min || x > max) {
              setvalidation1(a, b, c);
            } else if ((x >= min && x < b) || (x > c && x <= max)) {
              setvalidation2(a);
            } else if (x >= b && x <= c) {
              setvalidation3(a);
            }
          }
        }
      } else {
        setvalidation4(a);
      }
    }

    function setvalidation1(a, b, c) {
      alert("Please enter the value between " + b + " and " + c);
      document.getElementById(a).value = "";
      document.getElementById("");
      $("#" + a).focus();
      document.getElementById(a).style.color = "red";
      document.getElementById(a).style.backgroundColor = "yellow";
    }

    function setvalidation2(a) {
      document.getElementById(a).style.color = "red";
      document.getElementById(a).style.backgroundColor = "";
    }

    function setvalidation3(a) {
      document.getElementById(a).style.color = "black";
      document.getElementById(a).style.backgroundColor = "";
    }

    function setvalidation4(a) {
      alert("Please enter valid Numeric value");
      document.getElementById(a).value = "";
      document.getElementById("");
      $("#" + a).focus();
      document.getElementById(a).style.color = "red";
      document.getElementById(a).style.backgroundColor = "yellow";
    }
  </script>
</html>
{% endblock content %}