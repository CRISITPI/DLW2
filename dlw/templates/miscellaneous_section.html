{% extends 'base.html' %} {% block content %}
<html>
        <head>
<script>
    $(document).ready(function () {
        $('#date').datepicker({
            dateFormat: 'dd-mm-yy'
        });
    });
</script>
<script>
    $(document).ready(function () {
            $('#in_qty').datepicker({
                dateFormat: 'dd-mm-yy'
            });
        });
</script> 
<script>
    $(document).ready(function () {
            $('#out_qty').datepicker({
                dateFormat: 'dd-mm-yy'
            });
        });
</script>
<script>
    $(document).ready(function () {
            $('#editin_qty').datepicker({
                dateFormat: 'dd-mm-yy'
            });
        });
</script> 
<script>
    $(document).ready(function () {
        $('#editout_qty').datepicker({
            dateFormat: 'dd-mm-yy'
        });
    });
</script>
<script>
    $(document).ready(function () {
        $('#editdate').datepicker({
            dateFormat: 'dd-mm-yy'
        });
    });
</script>
<script>
        $(document).ready(function () {
                $('#dispatch_date').datepicker({
                    dateFormat: 'dd-mm-yy'
                });
            });
</script>
        </head> 
<style>
        .default {
            border-color: #e7e7e7;
            color: black;
          }
    #customers {
        font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
        border-collapse: collapse;
        margin-left: auto;
        margin-right: auto;
        width: 100%;
    }
    
    #customers td,
    #customers th {
        border: 1px solid #ddd;
        padding: 8px;
    }
    
    @import url('https://fonts.googleapis.com/css?family=Quicksand&display=swap');
    body {
        font-family: 'Quicksand', sans-serif;
        height: 100%;
        margin: 0;
    }
    
    html {
        height: 100%;
        margin: 0;
    }
    
    .page-content {
        min-height: 100%;
        margin-bottom: -40px;
    }
    
    .page-content::after {
        content: "";
        display: block;
    }
    
    footer,
    .page-content::after {
        height: 40px;
    }
    
    .content_section {
        width: 60%;
    }
</style>
<form action="." id="myForm" method="POST" novalidate>{% csrf_token %}

    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <ul class="navbar nav" style="width:60%">
            <font size="4pt" color="#FFFFFF">Miscellaneous Section</font>
        </ul>

        <div class="collapse navbar-collapse" id="collapse_target">
            <ul class="navbar nav" style="width:100%;">
                <li class="nav-item">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal3" style="background: none;font-size: 12pt;margin-Top:2%;margin-left: 2% ">
                    <font color="white">Delete</font>
                    </button>
                </li>
                <li class="nav-item">
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal2" style="background: none;font-size: 12pt;margin-Top:2%;margin-left: 2% ">
                        <font color="white">Dispatch</font>
                        </button>
                </li>
                <li class="nav-item">
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal1" style="background: none;font-size: 12pt;margin-Top:2%;margin-left: 2% ">
                        <font color="white">EditRecord</font>
                    </button>
                </li>
                <li class="nav-item">
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" style="background: none;font-size: 12pt;margin-Top:2%;margin-left: 2% ">
                                <font color="white">AddRecord</font>
                             </button>
                </li>
            </ul>
        </div>
    </nav>

    <table id="customers">
        <tbody>
            <tr>
                <center>
                    {% if messages %}
                        <ul class="messages">
                             {% for message in messages %}
                             <font size="3">
                             <li>
                                <h4>{{ message }}</h4>
                            </li>
                            </font>
                                {% endfor %}
                        </ul>
                            {% endif %}
                </center>
            </tr>
            <tr>
            <th>Serial No. &nbsp;</th>
            <th>Batch order No. &nbsp;</th>
            <th>Batch Order Date &nbsp;</th>
            <th>Part No. &nbsp;</th>
            <th>Batch Qty &nbsp;</th>
            <th>Loco Type &nbsp;</th>
            <th>In Quantity &nbsp;</th>
            <th>Out Quantity &nbsp;</th>
            <th>Shaft Machining &nbsp;</th>
            <th>Date &nbsp;</th>
            <th>Machine In Date &nbsp; </th>
            <th>Machine Out Date &nbsp; </th>
            <th>Dispatch To &nbsp;</th>
            </tr>
            {% for objec in object %}
            <tr>
            <td>{{objec.sno}} <br><br></td>
            <td>{{objec.bo_no}} <br><br></td>
            <td>{{objec.bo_date}} <br><br></td>
            <td>{{objec.pt_no}} <br><br></td>
            <td>{{objec.bo_qty}} <br><br></td>
            <td>{{objec.loco_type}} <br><br></td>
            <td>{{objec.in_qty}} <br><br></td>
            <td>{{objec.out_qty}} <br><br></td>
            <td>{{objec.shaft_m}} <br><br></td>
            <td>{{objec.date}} <br><br></td>
            <td>{{objec.in_qty}} <br><br></td>
            <td>{{objec.out_qty}} <br><br></td>
            <td>{{objec.dispatch_to}} <br><br></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <input type="hidden" name="once" id="once" value="0">

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Miscellaneous Section</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
                </div>
            
                <form method="POST" class="needs-validation" > {% csrf_token %}

                <div class="modal-body">
                                <div class="row">
                                    <div class="col-6">
                                        <label for="">Batch Order No.</label>
                                            <select name="bo_no" id="addbono" class="form-control ll" required>
                                                    <option value="" hidden selected>Select BO No.</option>  
                                                    {% for x in mybo %}
                                                    <option>{{x.bo_no}}</option>
                                                    {% endfor %}
                                            </select> 
                                    </div>
                                    <div class="col-6">
                                        <h6><label for="">Batch Order Date</label></h6>
                                        <input type="text" class="form-control" name="bo_date" id="bo_date" required readonly>
                                    </div>
                                </div>

                                <div class="row">
                                        <div class="col-6">
                                            <label>Part No.</label>
                                                <input type="text" class="form-control" name="pt_no" id="pt_no" required readonly>
                                                </div>
                                    <div class="col-6">
                                        <label>Batch Qty</label>
                                        <input type="text" class="form-control" name="bo_qty" id="bo_qty" required readonly>
                                    </div>
                                    </div>

                                <div class="row">
                                        <div class="col-6">
                                            <label>Loco Type</label>
                                                <input type="text" class="form-control" name="locos" id="locos" required readonly>
                                                </div>

                                    <div class="col-6">
                                        <h6><label>Shaft Machining</label></h6>
                                        <select class="btn default" name="shaft_m" id="shaft_m" type="form-control ll" required>
                                          <option value="" hidden selected>Shaft Machining</option>
                                          <option value="VERTICAL">Vertical</option>
                                          <option value="HORIZONTAL">Horizontal</option>
                                        </select>
                                    </div>
                                    </div>

                                        <div class="row">
                                                <div class="col-6">
                                                    <label for="">Machine In Date</label>
                                                    <input type="text" class="form-control" name="in_qty" id="in_qty" placeholder="dd-mm-yyyy" readonly>
                                                </div>
                                                <div class="col-6">
                                                    <label for="">Machine Out Date</label>
                                                    <input type="text" class="form-control" name="out_qty" id="out_qty" placeholder="dd-mm-yyyy" readonly>
                                                </div>
                                            </div>

                                        <div class="row">
                                                <div class="col-6">
                                                        <label for="">Date</label>
                                                        <input type="text" name="date" id="date" class="form-control" placeholder="dd-mm-yyyy" required readonly>
                                                </div>
                                        </div>            

                                    </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                 <input type="submit" name="submit" class="btn btn-primary" id="savebtn" value="Save" />
                            </div>
            </form>      
         </div>
     </div>
 </div>

        <!--EditRecord-->
        <!-- Modal -->
        <div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel1">Miscellaneous Section</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                        </button>
                </div>
                    <form method="POST" class="needs-validation" > {% csrf_token %}
                    <div class="modal-body">
                                    <div class="row">
                                        <div class="col-6">
                                                <label for="">S No.</label>
                                                <select name="editsno" id="editsno" class="form-control ll" required>
                                                    <option value="" hidden selected>Select S No.</option>  
                                                    {% for y in mysno %}
                                                    <option>{{y.sno}}</option>
                                                    {% endfor %}
                                            </select> 
                                        </div>
                                        <div class="col-6">
                                            <label for="">Batch Order No.</label>
                                            <input type="number" class="form-control" name="editbo_no" id="editbo_no" required readonly>
                                        </div>
                                    </div>

                                    <div class="row">
                                            <div class="col-6">
                                                    <h6><label>Part No.</label></h6>
                                                    <input type="text" class="form-control" name="editpt_no" id="editpt_no" required readonly>
                                            </div>
                                            <div class="col-6">
                                                    <h6><label>Batch Qty</label></h6>
                                                    <input type="text" class="form-control" name="editbo_qty" id="editbo_qty" required readonly>
                                            </div>
                                        </div>

                                    <div class="row">
                                        <div class="col-6">
                                                <label for="">Batch Order Date</label>
                                                <input type="date" class="form-control" name="editbo_date" id="editbo_date" placeholder="yyyy-mm-dd" required readonly>
                                        </div>
                                        <div class="col-6">
                                                <h6><label for="">Loco Type</label></h6>
                                                <input type="text" class="form-control" name="editlocos" id="editlocos" required readonly>
                                        </div>
                                    </div>

                                    <div class="row">
                                            <div class="col-6">
                                                    <label for="">Date(Manually)</label>
                                                    <input type="text" name="editdate" id="editdate" class="form-control" placeholder="dd-mm-yyyy" required readonly>
                                            </div>
                                        <div class="col-6">
                                            <h6><label>Shaft Machining</label></h6>
                                            <select class="btn default" name="editshaft_m" id="editshaft_m" type="form-control ll" required>
                                              <option value="" hidden selected>Shaft Machining</option>
                                              <option value="VERTICAL">Vertical</option>
                                              <option value="HORIZONTAL">Horizontal</option>
                                            </select>
                                        </div>
                                        </div>
                                        <div class="row">
                                                <div class="col-6">
                                                    <label for="">Machine In Date</label>
                                                    <input type="text" class="form-control" name="editin_qty" id="editin_qty" placeholder="dd-mm-yyyy" readonly>
                                                </div>
                                                <div class="col-6">
                                                    <label for="">Machine Out Date</label>
                                                    <input type="text" class="form-control" name="editout_qty" id="editout_qty" placeholder="dd-mm-yyyy" readonly>
                                                </div>
                                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <input type="submit" name="submit" class="btn btn-primary" id="editsavebtn" value="save">
                        </div>
                        </form>
                    </div>
                </div>
            </div>

            <!--Dispatch-->
            <!-- Modal -->
            <div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel2">Miscellaneous Section</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <form method="POST" class="needs-validation" > {% csrf_token %}
                        <div class="modal-body">
                                        <div class="row">
                                            <div class="col">
                                                <label for="">S No.</label>
                                                <input type="number" class="form-control" id="dissno" name="dissno" required>
                                            </div>
                                        </div>
                                        <br>
                                        <div class="row">
                                                <div class="col-6">
                                                        <label for="">Dispatch Date(Manually)</label>
                                                        <input type="text" name="dispatch_date" id="dispatch_date" class="form-control" placeholder="dd-mm-yyyy" required readonly>
                                                  </div>
                                        </div>
                                        <br>
                                            <div class="col">
                                                <div class="dropdown">
                                                    <select class="btn default" name="dislocos" type="form-control ll" required>
                                                    <option value="" hidden selected>Dispatch To</option>
                                                    <option value="BogieAssembly">Bogie Assembly and Dispatch</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <input type="submit" name="submit" class="btn btn-primary" id="dissavebtn" value="Dispatch">
                        </div>
                    </form>
                 </div>
            </div>
        </div>

            <!--Delete-->
            <!-- Modal -->
            <div class="modal fade" id="exampleModal3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel3" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel3">Miscellaneous Section</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                        </div>
                        <form method="POST" class="needs-validation" id="delform" > {% csrf_token %}

                        <div class="modal-body">
                                <div class="row">
                                    <div class="col">
                                        <h5><label>S No.</label></h5>
                                        <input type="number" class="form-control" id="delsno" name="delsno" required>
                                    </div>
                                </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <input type="submit" name="submit" class="btn btn-primary" id="delsavebtn" value="Delete">
                        </div>
                        </form>
                        </div>
                    </div>
                </div>

            </form>

            <script>
                $(document).ready(function() {
                    $('#delform').bootstrapValidator({
                        feedbackIcons: {
                            valid: 'glyphicon glyphicon-ok',
                            invalid: 'glyphicon glyphicon-remove',
                            validating: 'glyphicon glyphicon-refresh'
                        },
                        fields: {
                            delsno: {
                                validators: {
                                    notEmpty: {
                                        message: 'The username is required'
                                    }
                                }
                            }
                        }
                    });
                });
                
                $("#addbono").change(function(e){
                    e.preventDefault();
                    var selbo_no = $(this).val();
                    var data = {selbo_no};
                      $.ajax({
                        type : 'GET',
                        url : "{% url 'miscell_addbo' %}",
                        dataType : 'json',
                        data : data,
                        success : function(response){            
                            $("#bo_date").val(`${response[0].rel_date}`);
                            $("#locos").val(`${response[0].ep_type}`);
                            $("#pt_no").val(`${response[0].part_no}`);
                            $("#bo_qty").val(`${response[0].batch_qty}`);
                        }
                    })
                });

                $("#editsno").change(function(e){
                    e.preventDefault();
                    var sels_no=$(this).val();
                    var data={sels_no};
                        $.ajax({
                            type: 'GET',
                            url: "{% url 'miscell_editsno' %}",
                            dataType: 'json',
                            data:data,
                            success:function(response){
                                console.log(response);
                                $("#editbo_no").val(`${response[0].bo_no}`);
                                $("#editbo_date").val(`${response[0].bo_date}`);
                                $("#editlocos").val(`${response[0].loco_type}`);
                                $("#editpt_no").val(`${response[0].pt_no}`);
                                $("#editbo_qty").val(`${response[0].bo_qty}`);
                                $("#editdate").val(`${response[0].date}`);
                                $("#editshaft_m").val(`${response[0].shaft_m}`);
                                $("#editin_qty").val(`${response[0].in_qty}`);
                                $("#editout_qty").val(`${response[0].out_qty}`);
        
                            }
                        })
                }); 


            </script>
            </html>
            {% endblock content %}